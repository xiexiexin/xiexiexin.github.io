<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>[原]Hadoop 学习笔记八 任务远程提交--Eclipse插件 | 谢厂节的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Hadoop运行计算任务，大概有以下几种方式  把MapReduce任务打包到jar里，上传到服务器，用命令行启动 通过Java向Hadoop集群提交MapReduce任务 服务器的hadoop配置拷到本地，设置hosts指向namenode和resourcemanager，本地执行hadoop jar 任务做成schedule，定时调用shell脚本运行java任务 Eclipse的hadoop">
<meta property="og:type" content="article">
<meta property="og:title" content="[原]Hadoop 学习笔记八 任务远程提交--Eclipse插件">
<meta property="og:url" content="https://xiexiexin.github.io/2017/05/02/原-Hadoop-学习笔记八-任务远程提交-Eclipse插件/index.html">
<meta property="og:site_name" content="谢厂节的博客">
<meta property="og:description" content="Hadoop运行计算任务，大概有以下几种方式  把MapReduce任务打包到jar里，上传到服务器，用命令行启动 通过Java向Hadoop集群提交MapReduce任务 服务器的hadoop配置拷到本地，设置hosts指向namenode和resourcemanager，本地执行hadoop jar 任务做成schedule，定时调用shell脚本运行java任务 Eclipse的hadoop">
<meta property="og:image" content="http://img.blog.csdn.net/20170502090900550?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502090958890?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502104233658?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502154358670?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502150548947?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502161724340?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502161751388?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502163859276?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502155331440?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502155722109?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170502163621303?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170503084145116?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170503084118022?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170503095550293?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170503095943935?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:updated_time" content="2017-05-06T12:11:32.416Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[原]Hadoop 学习笔记八 任务远程提交--Eclipse插件">
<meta name="twitter:description" content="Hadoop运行计算任务，大概有以下几种方式  把MapReduce任务打包到jar里，上传到服务器，用命令行启动 通过Java向Hadoop集群提交MapReduce任务 服务器的hadoop配置拷到本地，设置hosts指向namenode和resourcemanager，本地执行hadoop jar 任务做成schedule，定时调用shell脚本运行java任务 Eclipse的hadoop">
<meta name="twitter:image" content="http://img.blog.csdn.net/20170502090900550?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
  
    <link rel="alternate" href="/atom.xml" title="谢厂节的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">谢厂节的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">技术小栈</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://xiexiexin.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-原-Hadoop-学习笔记八-任务远程提交-Eclipse插件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/02/原-Hadoop-学习笔记八-任务远程提交-Eclipse插件/" class="article-date">
  <time datetime="2017-05-02T02:42:57.000Z" itemprop="datePublished">2017-05-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      [原]Hadoop 学习笔记八 任务远程提交--Eclipse插件
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>Hadoop运行计算任务，大概有以下几种方式</strong></p>
<ol>
<li>把MapReduce任务打包到jar里，上传到服务器，用命令行启动</li>
<li>通过Java向Hadoop集群提交MapReduce任务</li>
<li>服务器的hadoop配置拷到本地，设置hosts指向namenode和resourcemanager，本地执行hadoop jar</li>
<li>任务做成schedule，定时调用shell脚本运行java任务</li>
<li>Eclipse的hadoop插件</li>
</ol>
<p>本文介绍第5种方式</p>
<h2 id="Eclipse下搭建hadoop2-7-3开发环境"><a href="#Eclipse下搭建hadoop2-7-3开发环境" class="headerlink" title="Eclipse下搭建hadoop2.7.3开发环境"></a>Eclipse下搭建hadoop2.7.3开发环境</h2><ol>
<li>下载并编译haddop-eclipse-plugin-2.7.3.jar</li>
<li>把hadoop-eclipse-plugin-2.7.3.jar放到myeclipse的安装目录下的plugins目录下，重启myeclipse</li>
<li>下载haddop2.7.3，并解压到c:\tools\hadoop-2.7.3</li>
<li>设置hosts将master.hadoop指向hadoop集群</li>
<li>设置Eclipes Hadoop位置</li>
</ol>
<p><img src="http://img.blog.csdn.net/20170502090900550?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20170502090958890?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h4 id="新建hadoop配置"><a href="#新建hadoop配置" class="headerlink" title="新建hadoop配置"></a>新建hadoop配置</h4><p><img src="http://img.blog.csdn.net/20170502104233658?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h5 id="参数说明："><a href="#参数说明：" class="headerlink" title="参数说明："></a>参数说明：</h5><p><strong>Map/Reduce(V2)Master </strong> </p>
<ul>
<li><p>Host hadoop主机地址 </p>
</li>
<li><p>Port 对应mapred-site.xml下的jobtracher地址</p>
<p> <span class="hljs-tag">&lt;<span class="hljs-title">property</span>&gt;</span></p>
<pre><code>&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;mapreduce.jobtracher.http.address&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-title&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;value&lt;/span&gt;&amp;gt;&lt;/span&gt;master.hadoop:50020&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-title&quot;&gt;value&lt;/span&gt;&amp;gt;&lt;/span&gt;
</code></pre><p> <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>`</p>
<p> <strong>DFS Master</strong> </p>
<ul>
<li><p>Port 对应core-site.xml下的fs.default.name端口</p>
<pre class="prettyprint">`<span class="hljs-tag">&lt;<span class="hljs-title">property</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">name</span>&gt;</span>fs.defaultFS<span class="hljs-tag">&lt;/<span class="hljs-title">name</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>hdfs://master.hadoop:9000<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>`</pre>

</li>
</ul>
</li>
</ul>
<ul>
<li>User name：填写windows的用户名    <strong>Advanced Parameters</strong></li>
<li><p>hadoop.tmp.dir 设置为core-site.xml下hadoop.tmp.dir参数</p>
<p>另外，修改hdfs-site.xml下的dfs.permission参数，允许连接</p>
<pre class="prettyprint">`<span class="hljs-tag">&lt;<span class="hljs-title">property</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">name</span>&gt;</span>dfs.permissions<span class="hljs-tag">&lt;/<span class="hljs-title">name</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>`</pre>

<p><strong>还要在hadoop新建目录</strong></p>
<pre class="prettyprint">`hdfs dfs <span class="hljs-attribute">-mkdir</span> <span class="hljs-attribute">-p</span> /user/hadoop/input
hdfs dfs <span class="hljs-attribute">-mkdir</span> <span class="hljs-attribute">-p</span> /user/hadoop/output`</pre>

<p>保存配置参数，并重启MyEclipse，可以看见如下的文件结构，配置成功。 </p>
<p><img src="http://img.blog.csdn.net/20170502154358670?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>（测试时遇到下面问题，未能解决，以后有时间再来处理，可以先不管它） </p>
<p><img src="http://img.blog.csdn.net/20170502150548947?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>**拷贝hadoop.dll和winutils </p>
<p>下载hadoop.dll和winutils.exe到windows的hadoop/bin下 </p>
<p>并把hadoop.dll添加到windows-&gt;system32</p>
<p><strong>新建环境变量</strong> </p>
<p><img src="http://img.blog.csdn.net/20170502161724340?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20170502161751388?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="新建项目测试"><a href="#新建项目测试" class="headerlink" title="新建项目测试"></a>新建项目测试</h2><p><strong>Hadoop建立测试文件</strong></p>
<pre class="prettyprint">`vi test.<span class="hljs-keyword">text</span>`</pre>

<pre class="prettyprint">`hello
world
who
are
you
thank you.
You are welcome.`</pre>

<pre class="prettyprint">`hdfs dfs <span class="hljs-attribute">-mkdir</span> <span class="hljs-attribute">-p</span> /user/hadoop/input
hdfs dfs <span class="hljs-attribute">-put</span> test<span class="hljs-built_in">.</span>txt /user/hadoop/input
hdfs dfs <span class="hljs-attribute">-chmod</span> <span class="hljs-number">777</span> /user/hadoop<span class="hljs-subst">/</span>`</pre>

<p><strong>新建 MapReduce项目</strong></p>
<p><strong>新建文件</strong> </p>
<p><img src="http://img.blog.csdn.net/20170502163859276?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"> </p>
<p><em>log4j.properties</em></p>
<pre class="prettyprint">`log4j<span class="hljs-preprocessor">.rootLogger</span>=DEBUG,stdout,R

log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.stdout</span>=org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.log</span>4j<span class="hljs-preprocessor">.ConsoleAppender</span> 
log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.stdout</span><span class="hljs-preprocessor">.layout</span>=org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.log</span>4j<span class="hljs-preprocessor">.PatternLayout</span> 
log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.stdout</span><span class="hljs-preprocessor">.layout</span><span class="hljs-preprocessor">.ConversionPattern</span>=%<span class="hljs-number">5</span>p - %m%n

log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.R</span>=org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.log</span>4j<span class="hljs-preprocessor">.RollingFileAppender</span> 
log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.R</span><span class="hljs-preprocessor">.File</span>=mapreduce_test<span class="hljs-preprocessor">.log</span> 
log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.R</span><span class="hljs-preprocessor">.MaxFileSize</span>=<span class="hljs-number">1</span>MB 
log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.R</span><span class="hljs-preprocessor">.MaxBackupIndex</span>=<span class="hljs-number">1</span> 
log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.R</span><span class="hljs-preprocessor">.layout</span>=org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.log</span>4j<span class="hljs-preprocessor">.PatternLayout</span> 
log4j<span class="hljs-preprocessor">.appender</span><span class="hljs-preprocessor">.R</span><span class="hljs-preprocessor">.layout</span><span class="hljs-preprocessor">.ConversionPattern</span>=%p %t %c - %m%n 
log4j<span class="hljs-preprocessor">.logger</span><span class="hljs-preprocessor">.com</span><span class="hljs-preprocessor">.codefutures</span>=INFO `</pre>

<p><em>WordCount.java</em></p>
<pre class="prettyprint">`package <span class="hljs-keyword">com</span><span class="hljs-preprocessor">.test</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-comment">;</span>

import java<span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.IOException</span><span class="hljs-comment">;</span>
import java<span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.StringTokenizer</span><span class="hljs-comment">;</span>

import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.conf</span><span class="hljs-preprocessor">.Configuration</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.fs</span><span class="hljs-preprocessor">.Path</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.IntWritable</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.Text</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.mapreduce</span><span class="hljs-preprocessor">.Job</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.mapreduce</span><span class="hljs-preprocessor">.Mapper</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.mapreduce</span><span class="hljs-preprocessor">.Reducer</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.mapreduce</span><span class="hljs-preprocessor">.lib</span><span class="hljs-preprocessor">.input</span><span class="hljs-preprocessor">.FileInputFormat</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.mapreduce</span><span class="hljs-preprocessor">.lib</span><span class="hljs-preprocessor">.output</span><span class="hljs-preprocessor">.FileOutputFormat</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.hadoop</span><span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.GenericOptionsParser</span><span class="hljs-comment">;</span>

public class WordCount {

    public static class TokenizerMapper extends
            Mapper&lt;Object, Text, Text, IntWritable&gt; {

        private final static IntWritable one = new IntWritable(<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
        private Text word = new Text()<span class="hljs-comment">;</span>

        public void map(Object key, Text value, Context context)
                throws IOException, InterruptedException {
            StringTokenizer itr = new StringTokenizer(value<span class="hljs-preprocessor">.toString</span>())<span class="hljs-comment">;</span>
            while (itr<span class="hljs-preprocessor">.hasMoreTokens</span>()) {
                word<span class="hljs-preprocessor">.set</span>(itr<span class="hljs-preprocessor">.nextToken</span>())<span class="hljs-comment">;</span>
                context<span class="hljs-preprocessor">.write</span>(word, one)<span class="hljs-comment">;</span>
            }
        }
    }

    public static class IntSumReducer extends
            Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
        private IntWritable result = new IntWritable()<span class="hljs-comment">;</span>

        public void reduce(Text key, Iterable&lt;IntWritable&gt; values,
                Context context) throws IOException, InterruptedException {
            int sum = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
            for (IntWritable val : values) {
                sum += val<span class="hljs-preprocessor">.get</span>()<span class="hljs-comment">;</span>
            }
            result<span class="hljs-preprocessor">.set</span>(sum)<span class="hljs-comment">;</span>
            context<span class="hljs-preprocessor">.write</span>(key, result)<span class="hljs-comment">;</span>
        }
    }

    public static void main(String[] args) throws Exception {
        //System<span class="hljs-preprocessor">.setProperty</span>(<span class="hljs-string">"hadoop.home.dir"</span>, <span class="hljs-string">"C:\\tools\\hadoop-2.7.3"</span>)<span class="hljs-comment">;  加这一句则可以不要设置环境变量</span>
        Configuration conf = new Configuration()<span class="hljs-comment">;</span>

        String[] otherArgs = new GenericOptionsParser(conf, args)
                <span class="hljs-preprocessor">.getRemainingArgs</span>()<span class="hljs-comment">;</span>
        if (otherArgs<span class="hljs-preprocessor">.length</span> != <span class="hljs-number">2</span>) {
            System<span class="hljs-preprocessor">.err</span><span class="hljs-preprocessor">.println</span>(otherArgs<span class="hljs-preprocessor">.length</span>)<span class="hljs-comment">;</span>
            System<span class="hljs-preprocessor">.err</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"Usage: wordcount &lt;in&gt; &lt;out&gt;"</span>)<span class="hljs-comment">;</span>
            System<span class="hljs-preprocessor">.exit</span>(<span class="hljs-number">2</span>)<span class="hljs-comment">;</span>
        }
        Job job = new Job(conf, <span class="hljs-string">"word count"</span>)<span class="hljs-comment">;</span>
        job<span class="hljs-preprocessor">.setJarByClass</span>(WordCount<span class="hljs-preprocessor">.class</span>)<span class="hljs-comment">;</span>
        job<span class="hljs-preprocessor">.setMapperClass</span>(TokenizerMapper<span class="hljs-preprocessor">.class</span>)<span class="hljs-comment">;</span>
        job<span class="hljs-preprocessor">.setCombinerClass</span>(IntSumReducer<span class="hljs-preprocessor">.class</span>)<span class="hljs-comment">;</span>
        job<span class="hljs-preprocessor">.setReducerClass</span>(IntSumReducer<span class="hljs-preprocessor">.class</span>)<span class="hljs-comment">;</span>
        job<span class="hljs-preprocessor">.setOutputKeyClass</span>(Text<span class="hljs-preprocessor">.class</span>)<span class="hljs-comment">;</span>
        job<span class="hljs-preprocessor">.setOutputValueClass</span>(IntWritable<span class="hljs-preprocessor">.class</span>)<span class="hljs-comment">;</span>
        FileInputFormat<span class="hljs-preprocessor">.addInputPath</span>(job, new Path(otherArgs[<span class="hljs-number">0</span>]))<span class="hljs-comment">;</span>
        FileOutputFormat<span class="hljs-preprocessor">.setOutputPath</span>(job, new Path(otherArgs[<span class="hljs-number">1</span>]))<span class="hljs-comment">;</span>
        System<span class="hljs-preprocessor">.exit</span>(job<span class="hljs-preprocessor">.waitForCompletion</span>(true) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
    }
}`</pre>

<p><strong>Run configuration</strong> </p>
<p><img src="http://img.blog.csdn.net/20170502155331440?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><strong>运行</strong> </p>
<p>右击testMapReduce项目，Run As-run on hadoop </p>
<p><img src="http://img.blog.csdn.net/20170502155722109?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><strong>查看结果</strong> </p>
<p><img src="http://img.blog.csdn.net/20170502163621303?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>然而在 <a href="http://master.hadoop:8088/cluster/apps" target="_blank" rel="external">http://master.hadoop:8088/cluster/apps</a>  </p>
<p>中并未发现提交的任务。 </p>
<p><strong>拷贝配置文件</strong></p>
<p><img src="http://img.blog.csdn.net/20170503084145116?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"> </p>
<p>从集群中拷贝 core-site.xml , hdfs-sie.xml , mapred-site.xml , yarn-site.xml到项目中。修改main函数：</p>
<pre class="prettyprint">`    Configuration conf = new Configuration()<span class="hljs-comment">;</span>

    conf<span class="hljs-preprocessor">.addResource</span>(<span class="hljs-string">"core-site.xml"</span>)<span class="hljs-comment">;</span>
    conf<span class="hljs-preprocessor">.addResource</span>(<span class="hljs-string">"hdfs-site.xml"</span>)<span class="hljs-comment">;</span>
    conf<span class="hljs-preprocessor">.addResource</span>(<span class="hljs-string">"mapred-site.xml"</span>)<span class="hljs-comment">;</span>
    conf<span class="hljs-preprocessor">.addResource</span>(<span class="hljs-string">"yarn-site.xml"</span>)<span class="hljs-comment">;</span>`</pre>

<p>再运行，遇到下面错误 </p>
<p><img src="http://img.blog.csdn.net/20170503084118022?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>参照 </p>
<p><a href="http://blog.csdn.net/xundh/article/details/46572183#t7" target="_blank" rel="external">http://blog.csdn.net/xundh/article/details/46572183#t7</a> </p>
<p>这里解决。</p>
<p>可以在All Applications看到任务运行情况。 </p>
<p><img src="http://img.blog.csdn.net/20170503095550293?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"> </p>
<p>运行失败，报异常信息： </p>
<p>Exception message: /bin/bash: 第 0 行:fg: 无任务控制 </p>
<p><img src="http://img.blog.csdn.net/20170503095943935?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHVuZGg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>处理方法 </p>
<p>在项目的core-site.xml添加：</p>
<pre class="prettyprint">`<span class="hljs-tag">&lt;<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">name</span>&gt;</span>mapreduce.app-submission.cross-platform<span class="hljs-tag">&lt;/<span class="hljs-title">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>`</pre>

<p>或main函数写：</p>
<p><pre class="prettyprint">`conf.<span class="hljs-operator"><span class="hljs-keyword">set</span>(<span class="hljs-string">“mapreduce.app-submission.cross-platform”</span>, <span class="hljs-string">“true”</span>);</span></pre></p>
<pre><code>&lt;div&gt;
    作者：xundh 发表于2017/5/2 10:42:57 [原文链接](http://blog.csdn.net/xundh/article/details/71078365)
&lt;/div&gt;
&lt;div&gt;
阅读：75 评论：0 [查看评论](http://blog.csdn.net/xundh/article/details/71078365#comments)
&lt;/div&gt;
</code></pre></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://xiexiexin.github.io/2017/05/02/原-Hadoop-学习笔记八-任务远程提交-Eclipse插件/" data-id="cj2d8n63e00084cm4yau8resy" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/05/03/原-Hadoop-学习笔记九-任务远程提交-Java远程提交/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          [原]Hadoop 学习笔记九 任务远程提交--Java远程提交
        
      </div>
    </a>
  
  
    <a href="/2017/04/28/原-Ionic-自动生成启动图标/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">[原]Ionic 自动生成启动图标</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/05/06/First-Article/">First Article</a>
          </li>
        
          <li>
            <a href="/2017/05/06/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2017/05/03/原-Hadoop-学习笔记十-HA高可用设置/">[原]Hadoop 学习笔记十 HA高可用设置</a>
          </li>
        
          <li>
            <a href="/2017/05/03/原-Hadoop-学习笔记九-任务远程提交-Java远程提交/">[原]Hadoop 学习笔记九 任务远程提交--Java远程提交</a>
          </li>
        
          <li>
            <a href="/2017/05/02/原-Hadoop-学习笔记八-任务远程提交-Eclipse插件/">[原]Hadoop 学习笔记八 任务远程提交--Eclipse插件</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 谢厂节(Cade)<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>